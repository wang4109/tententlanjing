(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f186126c"],{"151d":function(t,e,a){"use strict";a.r(e);var r=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticStyle:{width:"600px"}},[a("bk-form",{ref:"validateForm",attrs:{"label-width":200,model:t.formData,rules:t.rules}},[a("bk-form-item",{attrs:{label:"业务名称",required:!0,property:"task"}},[a("bk-select",{attrs:{searchable:""},model:{value:t.formData.task,callback:function(e){t.$set(t.formData,"task",e)},expression:"formData.task"}},t._l(t.taskList,function(t){return a("bk-option",{key:t.bk_biz_id,attrs:{id:t.bk_biz_name,name:t.bk_biz_name}})}),1)],1),a("bk-form-item",{attrs:{label:"模板类型",required:!0,property:"type"}},[a("bk-select",{attrs:{searchable:""},model:{value:t.formData.type,callback:function(e){t.$set(t.formData,"type",e)},expression:"formData.type"}},t._l(t.typeList,function(t){return a("bk-option",{key:t.id,attrs:{id:t.id,name:t.name}})}),1)],1),a("bk-form-item",{attrs:{label:"模板名称",required:!0,property:"name"}},[a("bk-input",{attrs:{placeholder:"请输入2到10个以内的字符"},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1),a("bk-form-item",{attrs:{label:"模板导入",required:!0,property:"templet"}},[a("bk-input",{attrs:{disabled:!0,placeholder:"请导入正确模板文件"},model:{value:t.formData.templet,callback:function(e){t.$set(t.formData,"templet",e)},expression:"formData.templet"}}),a("bk-upload",{attrs:{tip:"请选择要导入业务对应的模板文件，文件格式为*.xls或者*.xlsx","with-credentials":!0,"handle-res-code":t.handleRes,accept:"application/vnd.ms-excel",url:t.upload}}),a("a",{staticClass:"bk-text-button bk-primary",attrs:{href:t.demo,title:"下载"}},[a("i",{staticClass:"bk-icon icon-download"}),t._v("模板样例文件下载\n        ")])],1),a("bk-form-item",[a("bk-button",{attrs:{theme:"primary",title:"提交",loading:t.isChecking},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.validate(e)}}},[t._v("提交")]),a("bk-button",{attrs:{theme:"default",disabled:t.showStatus},on:{click:function(e){t.visiable=!0}}},[t._v("预览")]),a("bk-button",{attrs:{theme:"default",title:"取消"},on:{click:t.handleClick}},[t._v("返回")])],1)],1),a("bk-dialog",{attrs:{width:"800",position:{top:100,left:150},title:"模板预览"},model:{value:t.visiable,callback:function(e){t.visiable=e},expression:"visiable"}},[a("bk-table",{staticStyle:{"margin-top":"15px"},attrs:{data:t.data,"span-method":t.arraySpanMethod,"header-row-class-name":"templet-show-class",stripe:!0}},[a("bk-table-column",{attrs:{label:"步骤类别",prop:"step"}}),a("bk-table-column",{attrs:{label:"序号",prop:"id",width:"70"}}),a("bk-table-column",{attrs:{label:"操作事项",prop:"operate_attention"}}),a("bk-table-column",{attrs:{label:"备注",prop:"comment"}}),a("bk-table-column",{attrs:{label:"责任人",prop:"responser"}})],1)],1)],1)},s=[],i=(a("96cf"),a("3b8d")),n=a("6e87"),o=a("cd68"),l={components:{},data:function(){return{data:[],merge:[],demo:n["a"]+"./static/static/checklist.xls",upload:n["a"]+"api/loadExcel/",showStatus:!0,visiable:!1,isChecking:!1,formData:{name:"",type:"",task:"",templet:""},taskList:[],typeList:[],rules:{name:[{required:!0,message:"必填项",trigger:"blur"},{min:2,message:function(t){return"".concat(t,"不能小于2个字符")},trigger:"blur"},{max:10,message:"不能多于10个字符",trigger:"blur"}],type:[{required:!0,message:"请选择模板类型",trigger:"blur"}],task:[{required:!0,message:"请选择业务名称",trigger:"blur"}],templet:[{required:!0,message:"请导入xls或者xlsx模板文件",trigger:"blur"}]}}},mounted:function(){this.fetchBusinessList(),this.fetchTypeList()},methods:{fetchBusinessList:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["c"])();case 2:e=t.sent,a=e.data,r=e.status,/20\d/.test(r)&&(this.taskList=a.data.info);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),fetchTypeList:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(o["e"])();case 2:e=t.sent,a=e.data,r=e.status,/20\d/.test(r)&&(this.typeList=a.data);case 6:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),handleRes:function(t){return 0===t.code&&(this.formData.templet=t.data.uuid,this.showStatus=!1,this.data=t.data.parm_data,this.merge=t.data.merge,!0)},handleClick:function(){this.$router.push({name:"templetList"})},validate:function(){var t=this;this.isChecking=!0,this.$refs.validateForm.validate().then(function(e){Object(o["a"])(t.formData).then(function(e){e.status&&/20\d/.test(e.status)&&(e.data.status?(t.$bkInfo({type:"success",title:e.data.message,showFooter:!1}),t.$router.push({name:"templetList"})):t.$bkInfo({type:"error",title:e.data.message,showFooter:!1}))}),t.isChecking=!1},function(e){t.isChecking=!1,t.$bkInfo({type:"error",title:"".concat(e.content),showFooter:!1})})},arraySpanMethod:function(t){t.row,t.column;var e=t.rowIndex,a=t.columnIndex;for(var r in this.merge)if(a>=this.merge[r].col&&a<this.merge[r].col+this.merge[r].colspan&&e>=this.merge[r].row&&e<this.merge[r].row+this.merge[r].rowspan)return a===this.merge[r].col&&e===this.merge[r].row?[this.merge[r].rowspan,this.merge[r].colspan]:[0,0]}}},c=l,u=(a("a0dd"),a("2877")),m=Object(u["a"])(c,r,s,!1,null,null,null);e["default"]=m.exports},5969:function(t,e,a){},a0dd:function(t,e,a){"use strict";var r=a("5969"),s=a.n(r);s.a}}]);
//# sourceMappingURL=chunk-f186126c.00056a5a.js.map